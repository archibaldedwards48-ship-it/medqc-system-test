# å‰ç«¯å·¥ç¨‹å¸ˆå…¥èŒæŒ‡å— â€” ç—…ä¾‹è´¨æ§çŸ¥è¯†åº“ä¸è§„åˆ™å½’çº³ç³»ç»Ÿ

> **æ–‡æ¡£ç¼–å·**ï¼šFE-001  
> **è§’è‰²**ï¼šæ¶æ„å¸ˆ  
> **æ—¥æœŸ**ï¼š2026-02-26  
> **ç›®æ ‡è¯»è€…**ï¼šæ–°åŠ å…¥çš„å‰ç«¯å·¥ç¨‹å¸ˆ

---

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

### 1.1 ç³»ç»Ÿå®šä½

è¿™æ˜¯ä¸€ä¸ª**åŒ»é™¢ç—…å†è´¨é‡æ§åˆ¶ç³»ç»Ÿ**ï¼Œæ ¸å¿ƒåŠŸèƒ½æ˜¯ï¼š

1. åŒ»ç”Ÿä¸Šä¼ /ç¼–è¾‘ç—…å† â†’ ç³»ç»Ÿè‡ªåŠ¨è´¨æ§ â†’ è¾“å‡ºé—®é¢˜æ¸…å•å’Œè¯„åˆ†
2. ç®¡ç†å‘˜é…ç½®è´¨æ§è§„åˆ™ã€æŸ¥çœ‹ç»Ÿè®¡æŠ¥è¡¨ã€ç®¡ç†æœ¯è¯­åº“
3. æ”¯æŒ AI è¾…åŠ©è´¨æ§å’Œè§„åˆ™è‡ªåŠ¨è¿›åŒ–

### 1.2 å½“å‰çŠ¶æ€

**åç«¯å·²å®Œæˆé‡æ„**ï¼Œå‰ç«¯è¿˜æ˜¯åˆå§‹æ¨¡æ¿çŠ¶æ€ï¼ˆåªæœ‰ä¸€ä¸ªç©ºç™½ Home é¡µé¢ï¼‰ã€‚ä½ çš„ä»»åŠ¡æ˜¯**ä»é›¶æ­å»ºæ•´ä¸ªå‰ç«¯**ã€‚

åç«¯æä¾›çš„èƒ½åŠ›ï¼š
- NLP Pipelineï¼ˆ5 é˜¶æ®µï¼šæ®µè½ç´¢å¼•â†’è¯­ä¹‰æ–­è·¯å™¨â†’æŒ‡æ ‡æå–â†’é›¶é”šç‚¹æ¨æ–­â†’åŒ»å­¦æ ¡éªŒï¼‰
- QcEngineServiceï¼ˆ7 ä¸ªæ£€æŸ¥å™¨ï¼šå®Œæ•´æ€§ã€æ—¶é™æ€§ã€ä¸€è‡´æ€§ã€æ ¼å¼ã€é€»è¾‘ã€è¯Šæ–­å†…æ¶µã€ç”¨è¯å®‰å…¨ï¼‰
- 11 ä¸ª tRPC è·¯ç”±æ–‡ä»¶ï¼Œè¦†ç›–å…¨éƒ¨ä¸šåŠ¡åŠŸèƒ½
- ç”¨æˆ·è®¤è¯ï¼ˆManus OAuthï¼‰
- è§’è‰²æƒé™ï¼ˆadmin / userï¼‰

### 1.3 æŠ€æœ¯æ ˆ

| å±‚ | æŠ€æœ¯ | ç‰ˆæœ¬ |
|:---|:---|:---|
| æ¡†æ¶ | React | 19 |
| è·¯ç”± | wouter | 3.3 |
| æ ·å¼ | Tailwind CSS | 4 |
| ç»„ä»¶åº“ | shadcn/uiï¼ˆå·²é¢„è£… 50+ ç»„ä»¶ï¼‰ | latest |
| å›¾è¡¨ | Rechartsï¼ˆå·²å®‰è£…ï¼‰ | 2.15 |
| åŠ¨ç”» | Framer Motionï¼ˆå·²å®‰è£…ï¼‰ | 12 |
| å›¾æ ‡ | Lucide React | 0.453 |
| API | tRPC + React Query | 11 / 5 |
| ç±»å‹ | TypeScriptï¼ˆç«¯åˆ°ç«¯ç±»å‹å®‰å…¨ï¼‰ | â€” |
| ä¸»é¢˜ | next-themesï¼ˆå·²é…ç½®ï¼‰ | 0.4 |
| Markdown | Streamdown | 1.4 |
| æ—¥æœŸ | date-fns | 4.1 |
| è¡¨å• | React Hook Form + Zod | 7 / 4 |

**ä½ ä¸éœ€è¦å®‰è£…ä»»ä½•é¢å¤–ä¾èµ–**ï¼Œä»¥ä¸Šå…¨éƒ¨å·²åœ¨ `package.json` ä¸­ã€‚

---

## äºŒã€é¡¹ç›®ç»“æ„

```
medqc_system/
â”œâ”€â”€ client/
â”‚   â”œâ”€â”€ index.html                    â† HTML æ¨¡æ¿ï¼ˆå¯åŠ  Google Fontsï¼‰
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ App.tsx                   â† è·¯ç”±å®šä¹‰ï¼ˆä½ çš„ä¸»è¦å·¥ä½œåŒºï¼‰
â”‚       â”œâ”€â”€ main.tsx                  â† Provider æŒ‚è½½ï¼ˆä¸éœ€è¦æ”¹ï¼‰
â”‚       â”œâ”€â”€ index.css                 â† å…¨å±€ä¸»é¢˜å˜é‡ï¼ˆé¢œè‰²ã€åœ†è§’ã€å­—ä½“ï¼‰
â”‚       â”œâ”€â”€ const.ts                  â† getLoginUrl() ç­‰å¸¸é‡
â”‚       â”œâ”€â”€ _core/hooks/useAuth.ts    â† è®¤è¯ Hook
â”‚       â”œâ”€â”€ lib/
â”‚       â”‚   â”œâ”€â”€ trpc.ts              â† tRPC å®¢æˆ·ç«¯ï¼ˆä¸éœ€è¦æ”¹ï¼‰
â”‚       â”‚   â””â”€â”€ utils.ts             â† cn() å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ pages/                   â† é¡µé¢ç»„ä»¶ï¼ˆä½ çš„ä¸»è¦å·¥ä½œåŒºï¼‰
â”‚       â”‚   â”œâ”€â”€ Home.tsx             â† å½“å‰ç©ºç™½ï¼Œéœ€é‡å†™
â”‚       â”‚   â”œâ”€â”€ NotFound.tsx         â† 404 é¡µé¢
â”‚       â”‚   â””â”€â”€ ComponentShowcase.tsx â† ç»„ä»¶å±•ç¤ºï¼ˆå‚è€ƒç”¨ï¼‰
â”‚       â”œâ”€â”€ components/              â† å¯å¤ç”¨ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ DashboardLayout.tsx  â† ä¾§è¾¹æ å¸ƒå±€ï¼ˆç›´æ¥ç”¨ï¼‰
â”‚       â”‚   â”œâ”€â”€ AIChatBox.tsx        â† AI å¯¹è¯ç»„ä»¶ï¼ˆç›´æ¥ç”¨ï¼‰
â”‚       â”‚   â””â”€â”€ ui/                  â† shadcn/ui ç»„ä»¶ï¼ˆ50+ï¼‰
â”‚       â”œâ”€â”€ contexts/
â”‚       â”‚   â””â”€â”€ ThemeContext.tsx      â† ä¸»é¢˜åˆ‡æ¢
â”‚       â””â”€â”€ hooks/
â”‚           â”œâ”€â”€ useMobile.tsx        â† ç§»åŠ¨ç«¯æ£€æµ‹
â”‚           â””â”€â”€ useComposition.ts    â† è¾“å…¥æ³•ç»„åˆ
â”œâ”€â”€ server/                          â† åç«¯ï¼ˆä¸éœ€è¦æ”¹ï¼‰
â”‚   â”œâ”€â”€ routers.ts                   â† tRPC è·¯ç”±å…¥å£
â”‚   â””â”€â”€ ...
â”œâ”€â”€ drizzle/
â”‚   â””â”€â”€ schema.ts                    â† æ•°æ®åº“è¡¨å®šä¹‰ï¼ˆäº†è§£æ•°æ®ç»“æ„ï¼‰
â””â”€â”€ shared/
    â””â”€â”€ types.ts                     â† å…±äº«ç±»å‹
```

---

## ä¸‰ã€å¼€å‘ç¯å¢ƒ

### 3.1 å¯åŠ¨

```bash
# é¡¹ç›®å·²åœ¨ Manus å¹³å°è¿è¡Œï¼Œdev server è‡ªåŠ¨å¯åŠ¨
# å¦‚æœéœ€è¦æ‰‹åŠ¨å¯åŠ¨ï¼š
cd /home/ubuntu/medqc_system
pnpm dev
```

### 3.2 å…³é”®å‘½ä»¤

| å‘½ä»¤ | ç”¨é€” |
|:---|:---|
| `pnpm dev` | å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆå‰åç«¯åŒæ—¶ï¼‰ |
| `pnpm build` | æ„å»ºç”Ÿäº§ç‰ˆæœ¬ |
| `pnpm test` | è¿è¡Œ Vitest æµ‹è¯• |
| `pnpm db:push` | æ¨é€æ•°æ®åº“å˜æ›´ |

### 3.3 è®¤è¯

ç³»ç»Ÿä½¿ç”¨ Manus OAuthã€‚å¼€å‘æ—¶ï¼š
- è®¿é—®é¡µé¢ä¼šè‡ªåŠ¨è·³è½¬ç™»å½•
- ç™»å½•å `useAuth()` è¿”å›ç”¨æˆ·ä¿¡æ¯
- `user.role` ä¸º `'admin'` æˆ– `'user'`

---

## å››ã€tRPC ä½¿ç”¨æ–¹å¼

### 4.1 æ ¸å¿ƒåŸåˆ™

**ä½ ä¸éœ€è¦å†™ä»»ä½• API è°ƒç”¨ä»£ç ã€‚** tRPC æä¾›ç«¯åˆ°ç«¯ç±»å‹å®‰å…¨ï¼Œåç«¯å®šä¹‰äº†ä»€ä¹ˆï¼Œå‰ç«¯ç›´æ¥ç”¨ï¼š

```tsx
import { trpc } from '@/lib/trpc';

// æŸ¥è¯¢ï¼ˆè‡ªåŠ¨ç¼“å­˜ã€è‡ªåŠ¨é‡è¯•ï¼‰
const { data, isLoading, error } = trpc.records.list.useQuery({ page: 1, pageSize: 20 });

// å˜æ›´ï¼ˆå¸¦ä¹è§‚æ›´æ–°ï¼‰
const mutation = trpc.medicalRecord.upload.useMutation({
  onSuccess: () => {
    trpc.useUtils().records.list.invalidate();
  }
});
```

### 4.2 è®¤è¯

```tsx
import { useAuth } from '@/_core/hooks/useAuth';
import { getLoginUrl } from '@/const';

function MyPage() {
  const { user, loading, isAuthenticated, logout } = useAuth();
  
  if (loading) return <Skeleton />;
  if (!isAuthenticated) {
    window.location.href = getLoginUrl();
    return null;
  }
  
  // user.role === 'admin' å¯ä»¥åšç®¡ç†æ“ä½œ
  return <div>æ¬¢è¿, {user.name}</div>;
}
```

---

## äº”ã€18 ä¸ªé¡µé¢æ¸…å•ä¸ API æ˜ å°„

è¿™æ˜¯ç³»ç»Ÿéœ€è¦çš„å…¨éƒ¨é¡µé¢ã€‚æ¯ä¸ªé¡µé¢åˆ—å‡ºäº†å®ƒè°ƒç”¨çš„ tRPC æ¥å£â€”â€”**è¿™äº›æ¥å£åç«¯å·²ç»å…¨éƒ¨å®ç°**ï¼Œä½ åªéœ€è¦è°ƒç”¨ã€‚

### 5.1 å…¬å…±é¡µé¢

#### é¦–é¡µ / ç™»å½•å¼•å¯¼ (`/`)
- æœªç™»å½•ï¼šå±•ç¤ºç³»ç»Ÿä»‹ç» + ç™»å½•æŒ‰é’®
- å·²ç™»å½•ï¼šè·³è½¬åˆ°ä»ªè¡¨ç›˜
- APIï¼š`trpc.auth.me.useQuery()`

### 5.2 æ ¸å¿ƒä¸šåŠ¡é¡µé¢ï¼ˆæ‰€æœ‰ç”¨æˆ·ï¼‰

#### ç—…å†ç®¡ç† Records (`/records`)
åŠŸèƒ½ï¼šç—…å†åˆ—è¡¨ã€æœç´¢ã€ç­›é€‰ã€ä¸Šä¼ ã€æŸ¥çœ‹è¯¦æƒ…

| API è°ƒç”¨ | ç±»å‹ | è¯´æ˜ |
|:---|:---|:---|
| `trpc.records.list.useQuery({ page, pageSize, filters })` | query | ç—…å†åˆ—è¡¨ |
| `trpc.records.getById.useQuery({ id })` | query | ç—…å†è¯¦æƒ… |
| `trpc.medicalRecord.upload.useMutation()` | mutation | ä¸Šä¼ ç—…å†ï¼ˆWord/PDFï¼‰ |
| `trpc.medicalRecord.delete.useMutation()` | mutation | åˆ é™¤ç—…å† |

#### è´¨æ§ç»“æœ QCResults (`/qc-results`)
åŠŸèƒ½ï¼šè´¨æ§æ‰§è¡Œç»“æœåˆ—è¡¨ã€è¯¦æƒ…æŸ¥çœ‹ã€é—®é¢˜å®šä½

| API è°ƒç”¨ | ç±»å‹ | è¯´æ˜ |
|:---|:---|:---|
| `trpc.qcRecord.list.useQuery({ page, filters })` | query | è´¨æ§è®°å½•åˆ—è¡¨ |
| `trpc.qcRecord.getDetail.useQuery({ id })` | query | è´¨æ§è¯¦æƒ…ï¼ˆå«é—®é¢˜æ¸…å•ï¼‰ |

#### è´¨æ§å·¥ä½œå° QCWorkbench (`/qc-workbench`)
åŠŸèƒ½ï¼šå®æ—¶ç¼–è¾‘ç—…å† + å®æ—¶è´¨æ§åé¦ˆï¼ˆæ ¸å¿ƒé¡µé¢ï¼‰

| API è°ƒç”¨ | ç±»å‹ | è¯´æ˜ |
|:---|:---|:---|
| `trpc.realtime.submit.useMutation()` | mutation | æäº¤æ–‡æœ¬è¿›è¡Œå®æ—¶è´¨æ§ |
| `trpc.records.list.useQuery()` | query | é€‰æ‹©å·²æœ‰ç—…å† |

#### æˆ‘çš„è´¨æ§ MyQc (`/my-qc`)
åŠŸèƒ½ï¼šå½“å‰ç”¨æˆ·çš„è´¨æ§ä»»åŠ¡å’Œå†å²

| API è°ƒç”¨ | ç±»å‹ | è¯´æ˜ |
|:---|:---|:---|
| `trpc.qcRecord.list.useQuery({ userId })` | query | æˆ‘çš„è´¨æ§è®°å½• |
| `trpc.qcRecord.getDetail.useQuery({ id })` | query | è¯¦æƒ… |

### 5.3 ç®¡ç†é¡µé¢ï¼ˆadmin è§’è‰²ï¼‰

#### ç»Ÿè®¡ä»ªè¡¨ç›˜ Statistics (`/statistics`)
åŠŸèƒ½ï¼šè´¨æ§é€šè¿‡ç‡ã€è¶‹åŠ¿å›¾ã€ç§‘å®¤å¯¹æ¯”ã€è§„åˆ™å‘½ä¸­ç‡

| API è°ƒç”¨ | ç±»å‹ | è¯´æ˜ |
|:---|:---|:---|
| `trpc.stats.overview.useQuery()` | query | æ€»è§ˆæ•°æ® |
| `trpc.stats.trends.useQuery({ range })` | query | è¶‹åŠ¿æ•°æ®ï¼ˆæŠ˜çº¿å›¾ï¼‰ |
| `trpc.stats.departmentComparison.useQuery()` | query | ç§‘å®¤å¯¹æ¯”ï¼ˆæŸ±çŠ¶å›¾ï¼‰ |
| `trpc.stats.ruleHitRate.useQuery()` | query | è§„åˆ™å‘½ä¸­ç‡ï¼ˆé¥¼å›¾ï¼‰ |

#### è´¨æ§è§„åˆ™ç®¡ç† QCRules (`/qc-rules`)
åŠŸèƒ½ï¼šè§„åˆ™ CRUDã€å¯ç”¨/ç¦ç”¨ã€æ‰¹é‡å¯¼å…¥å¯¼å‡º

| API è°ƒç”¨ | ç±»å‹ | è¯´æ˜ |
|:---|:---|:---|
| `trpc.qcRules.list.useQuery({ page, filters })` | query | è§„åˆ™åˆ—è¡¨ |
| `trpc.qcRules.create.useMutation()` | mutation | åˆ›å»ºè§„åˆ™ |
| `trpc.qcRules.update.useMutation()` | mutation | æ›´æ–°è§„åˆ™ |
| `trpc.qcRules.delete.useMutation()` | mutation | åˆ é™¤è§„åˆ™ |
| `trpc.qcRules.toggle.useMutation()` | mutation | å¯ç”¨/ç¦ç”¨ |
| `trpc.qcRules.batchUpdate.useMutation()` | mutation | æ‰¹é‡æ›´æ–° |
| `trpc.qcRules.import.useMutation()` | mutation | å¯¼å…¥è§„åˆ™ |
| `trpc.qcRules.export.useQuery()` | query | å¯¼å‡ºè§„åˆ™ |

#### æŠ½æŸ¥ç®¡ç† SpotCheck (`/spot-check`)
åŠŸèƒ½ï¼šåˆ›å»ºæŠ½æŸ¥ä»»åŠ¡ã€æ‰§è¡ŒæŠ½æŸ¥ã€æŸ¥çœ‹ç»“æœ

| API è°ƒç”¨ | ç±»å‹ | è¯´æ˜ |
|:---|:---|:---|
| `trpc.spotCheck.list.useQuery()` | query | æŠ½æŸ¥åˆ—è¡¨ |
| `trpc.spotCheck.create.useMutation()` | mutation | åˆ›å»ºæŠ½æŸ¥ |
| `trpc.spotCheck.execute.useMutation()` | mutation | æ‰§è¡ŒæŠ½æŸ¥ |

#### è´¨æ§é…ç½®ä¸­å¿ƒ QCConfigCenter (`/qc-config`)
åŠŸèƒ½ï¼šè´¨æ§å‚æ•°é…ç½®ã€é›†æˆè®¾ç½®

| API è°ƒç”¨ | ç±»å‹ | è¯´æ˜ |
|:---|:---|:---|
| `trpc.qcConfig.get.useQuery()` | query | è·å–é…ç½® |
| `trpc.qcConfig.update.useMutation()` | mutation | æ›´æ–°é…ç½® |
| `trpc.qcConfig.getIntegration.useQuery()` | query | é›†æˆé…ç½® |
| `trpc.qcConfig.updateIntegration.useMutation()` | mutation | æ›´æ–°é›†æˆ |

#### ç”¨è¯å®‰å…¨é…ç½® MedicalSafetyConfig (`/medical-safety-config`)
åŠŸèƒ½ï¼šç”¨è¯å®‰å…¨è§„åˆ™ç®¡ç†

| API è°ƒç”¨ | ç±»å‹ | è¯´æ˜ |
|:---|:---|:---|
| `trpc.qcConfig.getSafetyRules.useQuery()` | query | å®‰å…¨è§„åˆ™ |
| `trpc.qcConfig.updateSafetyRules.useMutation()` | mutation | æ›´æ–°å®‰å…¨è§„åˆ™ |

#### ç”¨æˆ·ç®¡ç† Users (`/users`)
åŠŸèƒ½ï¼šç”¨æˆ·åˆ—è¡¨ã€è§’è‰²ç®¡ç†

| API è°ƒç”¨ | ç±»å‹ | è¯´æ˜ |
|:---|:---|:---|
| `trpc.user.list.useQuery()` | query | ç”¨æˆ·åˆ—è¡¨ |
| `trpc.user.updateRole.useMutation()` | mutation | ä¿®æ”¹è§’è‰² |
| `trpc.department.list.useQuery()` | query | ç§‘å®¤åˆ—è¡¨ |

#### å®¡æ ¸ç®¡ç† Review (`/review`)
åŠŸèƒ½ï¼šè´¨æ§ç»“æœå®¡æ ¸æµç¨‹

| API è°ƒç”¨ | ç±»å‹ | è¯´æ˜ |
|:---|:---|:---|
| `trpc.review.list.useQuery()` | query | å¾…å®¡æ ¸åˆ—è¡¨ |
| `trpc.review.approve.useMutation()` | mutation | é€šè¿‡ |
| `trpc.review.reject.useMutation()` | mutation | é©³å› |

### 5.4 é«˜çº§åŠŸèƒ½é¡µé¢

#### è§„åˆ™è¿›åŒ–ä»»åŠ¡ EvolutionTask (`/evolution-task`)
åŠŸèƒ½ï¼šAI è‡ªåŠ¨ç”Ÿæˆå’Œä¼˜åŒ–è´¨æ§è§„åˆ™

| API è°ƒç”¨ | ç±»å‹ | è¯´æ˜ |
|:---|:---|:---|
| `trpc.evolutionTask.list.useQuery()` | query | ä»»åŠ¡åˆ—è¡¨ |
| `trpc.evolutionTask.create.useMutation()` | mutation | åˆ›å»ºä»»åŠ¡ |
| `trpc.evolutionTask.execute.useMutation()` | mutation | æ‰§è¡Œä»»åŠ¡ |
| `trpc.evolutionTask.getResult.useQuery({ id })` | query | ä»»åŠ¡ç»“æœ |

#### åŒ»å­¦æœ¯è¯­åº“ Terminology (`/terminology`)
åŠŸèƒ½ï¼šæœ¯è¯­æœç´¢ã€è¯¦æƒ…ã€ç»Ÿè®¡ã€å¯¼å…¥å¯¼å‡º

| API è°ƒç”¨ | ç±»å‹ | è¯´æ˜ |
|:---|:---|:---|
| `trpc.terminology.search.useQuery({ keyword })` | query | æœç´¢æœ¯è¯­ |
| `trpc.terminology.getDetail.useQuery({ id })` | query | æœ¯è¯­è¯¦æƒ… |
| `trpc.terminology.getStatistics.useQuery()` | query | ç»Ÿè®¡ä¿¡æ¯ |
| `trpc.terminology.import.useMutation()` | mutation | å¯¼å…¥æœ¯è¯­ |
| `trpc.terminology.export.useQuery()` | query | å¯¼å‡ºæœ¯è¯­ |

#### PDF æŠ¥å‘Š PDFReport (`/pdf-report`)
åŠŸèƒ½ï¼šç”Ÿæˆè´¨æ§æŠ¥å‘Š PDF

| API è°ƒç”¨ | ç±»å‹ | è¯´æ˜ |
|:---|:---|:---|
| `trpc.pdf.generate.useMutation({ recordId })` | mutation | ç”Ÿæˆ PDF |
| `trpc.pdf.download.useQuery({ id })` | query | ä¸‹è½½ PDF |

#### AI è´¨æ§é¡¾é—® AIConsultant (`/ai-consultant`)
åŠŸèƒ½ï¼šAI å¯¹è¯å¼è´¨æ§å’¨è¯¢ï¼ˆä½¿ç”¨é¢„è£…çš„ AIChatBox ç»„ä»¶ï¼‰

| API è°ƒç”¨ | ç±»å‹ | è¯´æ˜ |
|:---|:---|:---|
| `trpc.ai.chat.useMutation()` | mutation | å‘é€æ¶ˆæ¯ |
| `trpc.ai.getHistory.useQuery()` | query | å†å²è®°å½• |

---

## å…­ã€å¯¼èˆªç»“æ„è®¾è®¡

æœ¬ç³»ç»Ÿæ˜¯**å†…éƒ¨ç®¡ç†å·¥å…·**ï¼Œä½¿ç”¨ `DashboardLayout`ï¼ˆä¾§è¾¹æ å¸ƒå±€ï¼‰ã€‚

### 6.1 ä¾§è¾¹æ èœå•ç»“æ„

```
ğŸ“Š ä»ªè¡¨ç›˜          /statistics          (admin)
ğŸ“‹ ç—…å†ç®¡ç†        /records             (all)
ğŸ” è´¨æ§å·¥ä½œå°      /qc-workbench        (all)
ğŸ“ æˆ‘çš„è´¨æ§        /my-qc               (all)
ğŸ“„ è´¨æ§ç»“æœ        /qc-results          (all)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âš™ï¸ è§„åˆ™ç®¡ç†        /qc-rules            (admin)
ğŸ¯ æŠ½æŸ¥ç®¡ç†        /spot-check          (admin)
ğŸ“ è´¨æ§é…ç½®        /qc-config           (admin)
ğŸ’Š ç”¨è¯å®‰å…¨        /medical-safety-config (admin)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§¬ æœ¯è¯­åº“          /terminology         (admin)
ğŸ”„ è§„åˆ™è¿›åŒ–        /evolution-task       (admin)
ğŸ‘¥ ç”¨æˆ·ç®¡ç†        /users               (admin)
ğŸ¤– AI é¡¾é—®        /ai-consultant       (all)
ğŸ“‘ PDF æŠ¥å‘Š       /pdf-report          (admin)
```

### 6.2 æƒé™æ§åˆ¶

```tsx
// åœ¨ DashboardLayout çš„ menuItems ä¸­æ ¹æ®è§’è‰²è¿‡æ»¤
const menuItems = allMenuItems.filter(item => {
  if (item.adminOnly && user?.role !== 'admin') return false;
  return true;
});
```

### 6.3 App.tsx è·¯ç”±æ³¨å†Œç¤ºä¾‹

```tsx
import DashboardLayout from '@/components/DashboardLayout';

function Router() {
  return (
    <Switch>
      <Route path="/" component={Home} />
      <Route path="/records" component={() => <DashboardLayout><Records /></DashboardLayout>} />
      <Route path="/qc-workbench" component={() => <DashboardLayout><QCWorkbench /></DashboardLayout>} />
      {/* ... å…¶ä»–è·¯ç”± */}
      <Route component={NotFound} />
    </Switch>
  );
}
```

---

## ä¸ƒã€è®¾è®¡æ–¹å‘

### 7.1 æ•´ä½“é£æ ¼

- **ç±»å‹**ï¼šä¸“ä¸šåŒ»ç–—ç®¡ç†ç³»ç»Ÿï¼Œåå‘ä¸¥è‚ƒã€å¯ä¿¡èµ–
- **ä¸»è‰²**ï¼šè“è‰²ç³»ï¼ˆå·²é…ç½®ï¼Œè§ index.css ä¸­çš„ `--primary: var(--color-blue-700)`ï¼‰
- **ä¸»é¢˜**ï¼šé»˜è®¤ Lightï¼Œæ”¯æŒåˆ‡æ¢ Darkï¼ˆThemeProvider å·²é…ç½®ï¼‰
- **åœ†è§’**ï¼š0.65remï¼ˆå·²é…ç½®ï¼‰
- **å­—ä½“**ï¼šå»ºè®®ä½¿ç”¨ Interï¼ˆè‹±æ–‡ï¼‰+ Noto Sans SCï¼ˆä¸­æ–‡ï¼‰ï¼Œåœ¨ `client/index.html` ä¸­æ·»åŠ  Google Fonts

### 7.2 è®¾è®¡åŸåˆ™

1. **ä¿¡æ¯å¯†åº¦é«˜**ï¼šåŒ»ç–—ç³»ç»Ÿç”¨æˆ·éœ€è¦åŒæ—¶çœ‹åˆ°å¤§é‡æ•°æ®ï¼Œä¸è¦è¿‡åº¦ç•™ç™½
2. **çŠ¶æ€æ¸…æ™°**ï¼šè´¨æ§é€šè¿‡/ä¸é€šè¿‡/å¾…å®¡æ ¸ ç”¨é¢œè‰²æ˜ç¡®åŒºåˆ†ï¼ˆç»¿/çº¢/é»„ï¼‰
3. **æ“ä½œå¯è¿½æº¯**ï¼šæ‰€æœ‰æ“ä½œéƒ½æœ‰æ—¶é—´æˆ³å’Œæ“ä½œäºº
4. **å“åº”å¼**ï¼šä¼˜å…ˆæ¡Œé¢ç«¯ï¼Œä½†ç§»åŠ¨ç«¯å¯ç”¨
5. **æ— éšœç¢**ï¼šä¿æŒç„¦ç‚¹ç¯ã€é”®ç›˜å¯è¾¾

### 7.3 å…³é”®é¡µé¢è®¾è®¡å»ºè®®

**ç»Ÿè®¡ä»ªè¡¨ç›˜**ï¼š
- é¡¶éƒ¨ 4 ä¸ª KPI å¡ç‰‡ï¼ˆæ€»ç—…å†æ•°ã€è´¨æ§é€šè¿‡ç‡ã€å¹³å‡åˆ†ã€å¾…å¤„ç†æ•°ï¼‰
- ä¸­é—´è¶‹åŠ¿æŠ˜çº¿å›¾ï¼ˆRechartsï¼‰
- ä¸‹æ–¹ç§‘å®¤å¯¹æ¯”æŸ±çŠ¶å›¾ + è§„åˆ™å‘½ä¸­ç‡é¥¼å›¾

**è´¨æ§å·¥ä½œå°**ï¼ˆæœ€å¤æ‚çš„é¡µé¢ï¼‰ï¼š
- å·¦ä¾§ï¼šç—…å†æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¯è€ƒè™‘ Textarea æˆ–å¯Œæ–‡æœ¬ï¼‰
- å³ä¾§ï¼šå®æ—¶è´¨æ§ç»“æœé¢æ¿ï¼ˆé—®é¢˜åˆ—è¡¨ã€ä¸¥é‡ç¨‹åº¦æ ‡è®°ï¼‰
- åº•éƒ¨ï¼šNLP åˆ†æç»“æœï¼ˆæ®µè½æ ‡æ³¨ã€æŒ‡æ ‡æå–ç»“æœï¼‰

**ç—…å†ç®¡ç†**ï¼š
- æ ‡å‡†æ•°æ®è¡¨æ ¼ï¼ˆTable ç»„ä»¶ï¼‰+ æœç´¢ + ç­›é€‰
- æ”¯æŒæ–‡ä»¶ä¸Šä¼ ï¼ˆæ‹–æ‹½åŒºåŸŸï¼‰
- è¡Œæ“ä½œï¼šæŸ¥çœ‹è¯¦æƒ…ã€æ‰§è¡Œè´¨æ§ã€åˆ é™¤

---

## å…«ã€é¢„è£…ç»„ä»¶æ¸…å•

ä»¥ä¸‹ç»„ä»¶å·²åœ¨ `client/src/components/ui/` ä¸‹ï¼Œ**ç›´æ¥ import ä½¿ç”¨**ï¼š

### å¸ƒå±€ä¸å¯¼èˆª
`accordion`, `breadcrumb`, `navigation-menu`, `sidebar`, `tabs`, `resizable`, `separator`, `scroll-area`

### æ•°æ®å±•ç¤º
`table`, `card`, `badge`, `avatar`, `progress`, `skeleton`, `chart`, `calendar`, `carousel`

### è¡¨å•ä¸è¾“å…¥
`button`, `input`, `textarea`, `select`, `checkbox`, `radio-group`, `switch`, `slider`, `form`, `field`, `label`, `input-otp`

### åé¦ˆä¸å¼¹å±‚
`dialog`, `alert-dialog`, `sheet`, `drawer`, `popover`, `hover-card`, `tooltip`, `sonner`(toast), `alert`, `spinner`

### å…¶ä»–
`dropdown-menu`, `context-menu`, `menubar`, `command`, `toggle`, `toggle-group`, `collapsible`, `pagination`, `aspect-ratio`, `kbd`, `empty`

### ä¸šåŠ¡ç»„ä»¶
- **DashboardLayout** â€” å®Œæ•´çš„ä¾§è¾¹æ å¸ƒå±€ï¼Œå«è®¤è¯å¤„ç†ã€ç”¨æˆ·å¤´åƒã€å¯è°ƒå®½åº¦
- **AIChatBox** â€” AI å¯¹è¯ç•Œé¢ï¼Œå«æ¶ˆæ¯å†å²ã€æµå¼æ¸²æŸ“ã€Markdown æ”¯æŒ

---

## ä¹ã€æ‰§è¡Œè®¡åˆ’ï¼ˆå»ºè®®é¡ºåºï¼‰

### Phase 1ï¼šåŸºç¡€æ¡†æ¶ï¼ˆDay 1-2ï¼‰
1. é…ç½®å…¨å±€ä¸»é¢˜ï¼ˆå­—ä½“ã€é¢œè‰²å¾®è°ƒï¼‰
2. ä¿®æ”¹ DashboardLayout çš„ menuItems ä¸ºå®é™…èœå•
3. æ³¨å†Œæ‰€æœ‰è·¯ç”±åˆ° App.tsx
4. åˆ›å»º 18 ä¸ªé¡µé¢æ–‡ä»¶çš„éª¨æ¶ï¼ˆæ ‡é¢˜ + Loading çŠ¶æ€ï¼‰

### Phase 2ï¼šæ ¸å¿ƒé¡µé¢ï¼ˆDay 3-5ï¼‰
5. ç—…å†ç®¡ç†é¡µé¢ï¼ˆRecordsï¼‰â€” è¡¨æ ¼ + ä¸Šä¼  + CRUD
6. è´¨æ§ç»“æœé¡µé¢ï¼ˆQCResultsï¼‰â€” ç»“æœåˆ—è¡¨ + è¯¦æƒ…å±•ç¤º
7. è´¨æ§å·¥ä½œå°ï¼ˆQCWorkbenchï¼‰â€” ç¼–è¾‘å™¨ + å®æ—¶åé¦ˆï¼ˆæœ€å¤æ‚ï¼‰
8. ç»Ÿè®¡ä»ªè¡¨ç›˜ï¼ˆStatisticsï¼‰â€” KPI + å›¾è¡¨

### Phase 3ï¼šç®¡ç†é¡µé¢ï¼ˆDay 6-8ï¼‰
9. è´¨æ§è§„åˆ™ç®¡ç†ï¼ˆQCRulesï¼‰â€” è¡¨æ ¼ + CRUD + å¯¼å…¥å¯¼å‡º
10. ç”¨æˆ·ç®¡ç†ï¼ˆUsersï¼‰â€” è¡¨æ ¼ + è§’è‰²åˆ‡æ¢
11. æŠ½æŸ¥ç®¡ç†ï¼ˆSpotCheckï¼‰â€” åˆ›å»º + æ‰§è¡Œ + ç»“æœ
12. è´¨æ§é…ç½®ï¼ˆQCConfigCenter + MedicalSafetyConfigï¼‰

### Phase 4ï¼šé«˜çº§åŠŸèƒ½ï¼ˆDay 9-10ï¼‰
13. æœ¯è¯­åº“ï¼ˆTerminologyï¼‰â€” æœç´¢ + è¯¦æƒ…
14. è§„åˆ™è¿›åŒ–ï¼ˆEvolutionTaskï¼‰â€” ä»»åŠ¡ç®¡ç†
15. AI é¡¾é—®ï¼ˆAIConsultantï¼‰â€” ä½¿ç”¨ AIChatBox
16. PDF æŠ¥å‘Šï¼ˆPDFReportï¼‰
17. å®¡æ ¸ç®¡ç†ï¼ˆReviewï¼‰
18. æˆ‘çš„è´¨æ§ï¼ˆMyQcï¼‰

### Phase 5ï¼šæ‰“ç£¨ï¼ˆDay 11-12ï¼‰
19. ç©ºçŠ¶æ€ã€é”™è¯¯çŠ¶æ€ã€Loading çŠ¶æ€å®Œå–„
20. ç§»åŠ¨ç«¯é€‚é…
21. æš—è‰²ä¸»é¢˜é€‚é…
22. å¾®äº¤äº’åŠ¨ç”»ï¼ˆFramer Motionï¼‰

---

## åã€æ³¨æ„äº‹é¡¹

### 10.1 å¿…é¡»éµå®ˆ

- **ä¸è¦ä¿®æ”¹ `server/` ç›®å½•ä¸‹çš„ä»»ä½•æ–‡ä»¶**
- **ä¸è¦ä¿®æ”¹ `client/src/_core/`ã€`client/src/lib/trpc.ts`ã€`client/src/main.tsx`**
- **ä¸è¦å®‰è£…æ–°çš„ HTTP å®¢æˆ·ç«¯**ï¼ˆå¦‚ axios è°ƒç”¨ã€fetch å°è£…ï¼‰ï¼Œå…¨éƒ¨ç”¨ tRPC
- **ä¸è¦æ‰‹åŠ¨æ“ä½œ Cookie**ï¼Œè®¤è¯ç”±æ¡†æ¶å¤„ç†
- tRPC è°ƒç”¨çš„å‘½åç©ºé—´å’Œæ–¹æ³•å**å¿…é¡»ä¸åç«¯å®Œå…¨ä¸€è‡´**ï¼ˆå¤§å°å†™æ•æ„Ÿï¼‰

### 10.2 å¸¸è§é™·é˜±

**æ— é™åŠ è½½å¾ªç¯**ï¼šä¸è¦åœ¨ render ä¸­åˆ›å»ºæ–°å¯¹è±¡ä½œä¸º query å‚æ•°
```tsx
// âŒ é”™è¯¯ï¼šæ¯æ¬¡æ¸²æŸ“åˆ›å»ºæ–°å¯¹è±¡
const { data } = trpc.records.list.useQuery({ date: new Date() });

// âœ… æ­£ç¡®ï¼šç”¨ useState ç¨³å®šå¼•ç”¨
const [date] = useState(() => new Date());
const { data } = trpc.records.list.useQuery({ date });
```

**ä¸»é¢˜é¢œè‰²ä¸åŒ¹é…**ï¼šä½¿ç”¨è¯­ä¹‰è‰²æ—¶å¿…é¡»æˆå¯¹
```tsx
// âŒ é”™è¯¯ï¼šåªè®¾èƒŒæ™¯ä¸è®¾æ–‡å­—
<div className="bg-card">...</div>

// âœ… æ­£ç¡®ï¼šèƒŒæ™¯å’Œæ–‡å­—æˆå¯¹
<div className="bg-card text-card-foreground">...</div>
```

**åµŒå¥—é”šç‚¹**ï¼šwouter çš„ Link å†…éƒ¨å·²ç»æ˜¯ `<a>`
```tsx
// âŒ é”™è¯¯
<Link><a href="...">text</a></Link>

// âœ… æ­£ç¡®
<Link href="...">text</Link>
```

### 10.3 ä¸åç«¯åä½œ

- å¦‚æœéœ€è¦åç«¯**æ–°å¢æ¥å£**ï¼Œç›´æ¥å‘Šè¯‰åç«¯å·¥ç¨‹å¸ˆéœ€è¦ä»€ä¹ˆæ•°æ®ã€ä»€ä¹ˆæ ¼å¼
- å¦‚æœå‘ç°åç«¯æ¥å£è¿”å›çš„æ•°æ®ç»“æ„ä¸ç¬¦åˆé¢„æœŸï¼Œå…ˆæ£€æŸ¥ `server/routers/` å¯¹åº”æ–‡ä»¶çš„ç±»å‹å®šä¹‰
- æ‰€æœ‰ç±»å‹éƒ½æ˜¯è‡ªåŠ¨æ¨å¯¼çš„ï¼ŒIDE ä¼šæç¤ºå¯ç”¨çš„å­—æ®µ

---

## åä¸€ã€å¿«é€Ÿå‚è€ƒ

### å¸¸ç”¨ import

```tsx
// è®¤è¯
import { useAuth } from '@/_core/hooks/useAuth';
import { getLoginUrl } from '@/const';

// tRPC
import { trpc } from '@/lib/trpc';

// UI ç»„ä»¶
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';
import { Badge } from '@/components/ui/badge';
import { Input } from '@/components/ui/input';
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Skeleton } from '@/components/ui/skeleton';
import { toast } from 'sonner';

// å›¾æ ‡
import { Plus, Search, Filter, Download, Upload, Trash2, Edit, Eye, Check, X } from 'lucide-react';

// å›¾è¡¨
import { LineChart, Line, BarChart, Bar, PieChart, Pie, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';

// å¸ƒå±€
import DashboardLayout from '@/components/DashboardLayout';

// å·¥å…·
import { cn } from '@/lib/utils';
```

### é¡µé¢æ¨¡æ¿

```tsx
import { trpc } from '@/lib/trpc';
import { useAuth } from '@/_core/hooks/useAuth';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Skeleton } from '@/components/ui/skeleton';
import { Empty } from '@/components/ui/empty';

export default function FeaturePage() {
  const { user } = useAuth();
  const { data, isLoading, error } = trpc.feature.list.useQuery();

  if (isLoading) {
    return (
      <div className="p-6 space-y-4">
        <Skeleton className="h-8 w-48" />
        <Skeleton className="h-64 w-full" />
      </div>
    );
  }

  if (error) {
    return <div className="p-6 text-destructive">åŠ è½½å¤±è´¥: {error.message}</div>;
  }

  if (!data?.length) {
    return <Empty description="æš‚æ— æ•°æ®" />;
  }

  return (
    <div className="p-6 space-y-6">
      <h1 className="text-2xl font-semibold">é¡µé¢æ ‡é¢˜</h1>
      {/* é¡µé¢å†…å®¹ */}
    </div>
  );
}
```
